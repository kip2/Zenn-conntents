---
title: "ç¹°ã‚Šè¿”ã—æ§‹æ–‡ã®ç°¡å˜ãªã¾ã¨ã‚"
emoji: "ðŸˆï¸"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["clojure"]
published: false
---

# map

ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã™ã‚‹éš›ã«ä½¿ã†ã€‚
ãƒªã‚¹ãƒˆã®å„è¦ç´ ã«å¯¾ã—ã¦é–¢æ•°ã‚’é©ç”¨ã™ã‚‹å ´åˆã€è¤‡æ•°ã®ãƒªã‚¹ãƒˆåŒå£«ã«é–¢æ•°ã‚’é©ç”¨ã™ã‚‹å ´åˆã«ä½¿ç”¨ã™ã‚‹ã€‚

```clojure
(map inc [1 2 3])
;; (2 3 4)

;; å°‘ã—å›žã‚Šãã©ã„ãŒã€ç„¡åé–¢æ•°ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã‚‚å®Ÿç¾ã§ãã‚‹
(map (fn [x] (+ 1 x)) [1 2 3])
;; (2 3 4)

;; ç„¡åé–¢æ•°ã ã¨ã€é–¢æ•°ãŒå­˜åœ¨ã—ã¦ã„ãªã„å ´åˆã§ã‚‚ã‚«ã‚¹ã‚¿ãƒ ã§å‹•ä½œã‚’æ‹¡å¼µã§ãã‚‹
(map (fn [x] (+ 2 x)) [1 2 3])
;; (3 4 5)

;; è¤‡æ•°ã®ã‚·ãƒ¼ã‚±ãƒ³ã‚¹é–“ã§é–¢æ•°ã‚’é©ç”¨ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½
(map + [1 2 3] [3 4 5])
;; (4 6 8)

;; 2ã¤ä»¥ä¸Šã®ãƒªã‚¹ãƒˆã‚’ä½¿ç”¨ã§ãã‚‹
(map (fn [x y] [x y]) [1 2 3] [3 4 5])
;; ([1 3] [2 4] [3 5])
(map (fn [x y z] [x y z]) [1 2 3] [3 4 5] [7 8 9])
;; ([1 3 7] [2 4 8] [3 5 9])
```


# for

forã¯ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’å¤‰æ›ã™ã‚‹å ´åˆã«ä½¿ã†ã€‚
mapã§ä»£æ›¿ã§ãã‚‹ã“ã¨ã‚‚å¤šã„ãŒã€ã‚ˆã‚ŠæŸ”è»Ÿã«ã€ã‚«ã‚¹ã‚¿ãƒžã‚¤ã‚ºã—ãŸã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚’ç”Ÿæˆã™ã‚‹å ´åˆã«ä½¿ç”¨ã§ãã‚‹ã€‚

```clojure
(for [x (range 10)]
  x)
;; (0 1 2 3 4 5 6 7 8 9)

(for [x (range 10)
      :when (even? x)]
  x)
;; (0 2 4 6 8)

(for [x (range 10)
      :let [y (* x 2)]]
  y)
;; (0 2 4 6 8 10 12 14 16 18)

(for [x [1 2 3]
      y [10 20]]
  (* x y))
;; (10 20 20 40 30 60)

;; æ–‡å­—åˆ—ã§ã‚‚å¯èƒ½
(for [a ["a" "b" "c"]]
  a)
;; ("a" "b" "c")

(for [a ["a" "b" "c"]
      b ["Alice" "Bob" "Charie"]]
  (str a ":" b))

(for [a ["Alice" "Bob" "Charie"]
      :when (str/starts-with? a "A")]
  a)
;; ("Alice")

(for [a ["Alice" "Bob" "Charie"]
      :when (str/ends-with? a "e")]
  a)
;; ("Alice" "Charie")
```

## forã¨mapã®é•ã„

ã€ŒåŒã˜ãç¹°ã‚Šè¿”ã—ã‚’ãŠã“ãªã£ã¦ãƒªã‚¹ãƒˆã‚’è¿”ã™ã®ã ã‹ã‚‰åŒã˜ã‚‚ã®ã§ã¯ï¼Ÿã€ã¨æ€ã£ãŸã‘ã©ã€`for`ã®æ–¹ãŒæŸ”è»Ÿæ€§ãŒã‚ã‚‹ã—ã€åŒã˜ã“ã¨ã‚’å†ç¾ã—ã‚ˆã†ã¨ã—ãŸã‚‰å¯èª­æ€§ãŒé«˜ã„ã€‚

ä»¥ä¸‹ã¯ãã®ä¾‹ã€‚
`for`ã§ã§ãã‚‹ã“ã¨ã¨å¼•ãè¼ƒã¹ã¦è¨˜è¼‰ã™ã‚‹ã€‚

è¤‡æ•°ã®ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã¯ã€`for`ã®æ–¹ãŒæ›¸ãã‚„ã™ã„ã—ã€èª­ã¿ã‚„ã™ã„ã€‚

```clojure
;; forã®å ´åˆ
(for [x (range 3)
      y (range 3)]
  [x y])
;; ([0 0] [0 1] [0 2] [1 0] [1 1] [1 2] [2 0] [2 1] [2 2])

;; mapã®å ´åˆ
(apply concat (map (fn [x] (map (fn [y]
                                  [x y])
                                (range 3))) (range 3)))
;; ([0 0] [0 1] [0 2] [1 0] [1 1] [1 2] [2 0] [2 1] [2 2])
```

ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã«ã¤ã„ã¦ã‚‚ã€`for`ã®æ–¹ãŒå¯èª­æ€§ãŒé«˜ã„ã‚ˆã†ã«æ€ãˆã‚‹ã€‚

```clojure
;; forã®å ´åˆ
(for [x (range 10)
      :when (even? x)]
  x)
;; (0 2 4 6 8)

;; mapã®å ´åˆ
;; ã“ã®ã¾ã¾ã ã¨nilãŒæ®‹ã‚‹ã®ã§ã€å‰Šé™¤ãŒå¿…è¦
(map (fn [x] (when (even? x) x)) (range 10))
;; (0 nil 2 nil 4 nil 6 nil 8 nil)

;; nilã‚’æŽ’é™¤ã—ãŸã‚‚ã®
;; removeç‰ˆ
(remove nil? (map (fn [x] (when (even? x) x)) (range 10)))
;; (0 2 4 6 8)

;; filterç‰ˆ
(filter some? (map (fn [x] (when (even? x) x)) (range 10)))
;; (0 2 4 6 8)
```

è¤‡æ•°ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚’è¡Œã†å ´åˆã¯ã€æ˜Žã‚‰ã‹ã«`for`ã®æ–¹ãŒå¯èª­æ€§ãŒé«˜ã„ã€‚

```clojure
(for [x (range 10)
      :when (odd? x)
      :when (>= x 3)]
  x)
;; (3 5 7 9)

(filter #(and (odd? %) (>= % 3)) (range 10))
;; (3 5 7 9)
```

ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã«ã‚ˆã‚‹æ›¸ãæ–¹ã¯ã€`map`ã®æ–¹ãŒèª­ã¿ã‚„ã™ã„ã¨ã„ã†äººã‚‚ã„ã‚‹ã‹ã‚‚çŸ¥ã‚Œãªã„ã€‚


```clojure
(for [x (range 5)
      :let [y (* x x)]]
  y)
;; (0 1 4 9 16)

(map (fn [x] (* x x)) (range 5))
;; (0 1 4 9 16)
```

ã—ã‹ã—ã€ã•ã‚‰ã«è¤‡é›‘ã«ã™ã‚‹ã¨ã€ã‚„ã¯ã‚Š`for`ã®æ–¹ãŒèª­ã¿ã‚„ã™ã„ã€‚

```clojure
;; ã‚‚ã†ã¡ã‚‡ã£ã¨è¤‡é›‘ãªä¾‹
(for [x (range 1 11)
      :let [double (* 2 x)
            square (* double double)]
      :when (>= square 50)]
  square)
;; (64 100 144 196 256 324 400)

(filter some?
        (map
         (fn [x] (let [double (* 2 x)
                       square (* double double)]
                   (when (>= square 50)
                     square)))
         (range 1 11)))
;; (64 100 144 196 256 324 400)
```



