---
title: "ã‚¹ãƒ¬ãƒƒãƒ‡ã‚£ãƒ³ã‚°ãƒã‚¯ãƒ­ã®å±•é–‹ã®é•ã„"
emoji: "ğŸˆï¸"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["clojure"]
published: true
---

~~ãƒã‚¯ãƒ­ã‚’å±•é–‹ã•ã›ã¦éŠã‚“ã§ã„ã‚‹ã¨ãã«ã€ã€Œã‚¹ãƒ¬ãƒƒãƒ‡ã‚£ãƒ³ã‚°ãƒã‚¯ãƒ­ã¨åå‰ãŒã¤ã„ã¦ã„ã‚‹ãã‚‰ã„ã ã—ã€ã“ã‚Œã‚‚ãƒã‚¯ãƒ­ã ã‚ˆãªã€ã¨ãªã£ãŸã®ã§ã€å±•é–‹ã•ã›ã¦éŠã‚“ã è¨˜äº‹ã§ã™ã€‚~~
ã‚¹ãƒ¬ãƒƒãƒ‡ã‚£ãƒ³ã‚°ãƒã‚¯ãƒ­ã®é•ã„ã«ã¤ã„ã¦æ°—ã«ãªã£ãŸã®ã§ã€`macroexpand-1`ã‚’ç”¨ã„ã¦ç°¡å˜ã«èª¿ã¹ãŸè¨˜äº‹ã§ã™ã€‚

ãªãŠã€ä»Šå›å–ã‚Šä¸Šã’ã‚‹ã®ã¯`->`ã¨`->>`ã«ãªã‚Šã¾ã™ã€‚

## ã‚¹ãƒ¬ãƒƒãƒ‡ã‚£ãƒ³ã‚°ãƒã‚¯ãƒ­ã£ã¦ä½•ï¼Ÿ

ä»¥ä¸‹ã®è¨˜äº‹ã«è©³ã—ã„ã§ã™ãŒã€ã€Œã‚«ãƒƒã‚³ã§ãƒã‚¹ãƒˆã•ã‚Œã‚‹èª­ã¿ã¥ã‚‰ãæ›¸ãã¥ã‚‰ã„è¨˜æ³•ã‚’ç°¡æ½”ã«æ›¸ããŸã‚ã®ãƒã‚¯ãƒ­ã€ã¨è€ƒãˆã¦ã„ã„ã¨æ€ã„ã¾ã™ã€‚

https://note.com/mi_nil/n/n78f1701bccb0

ã‚¹ãƒ¬ãƒƒãƒ‡ã‚£ãƒ³ã‚°ãƒã‚¯ãƒ­ã‚’ä½¿ã‚ãªã„å ´åˆã¯ã€èª­ã¿ã¥ã‚‰ãæ›¸ãã¥ã‚‰ã„ãŒã€

```clojure
;; ã‚ã‚‹æ•°xãŒã‚ã£ãŸå ´åˆã€‚
(h (g (f x)))

;; ä¾‹ã¨ã—ã¦ä»¥ä¸‹ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ãŒè€ƒãˆã‚‰ã‚Œã‚‹ã€‚

;; å˜ç´”ãªincã®é©ç”¨ã€‚
(inc (inc (inc 1)))
;; 4

;; 50å††ã®å•†å“ã‚’10å€‹è²·ã£ãŸåˆè¨ˆå€¤(ç¨ç‡10ï¼…)ã€‚
(str "total: "
     (int
      (* 1.10
         (* 10 50))))
;; "total: 550" 
```

ã‚¹ãƒ¬ãƒƒãƒ‡ã‚£ãƒ³ã‚°ãƒã‚¯ãƒ­ã‚’ä½¿ã†ã¨ã™ã£ãã‚Šã™ã‚‹ã€‚

```clojure
(-> x
    f
    g
    h)

;; å®Ÿä¾‹ã‚’åŒã˜ã‚ˆã†ã«ã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚‹ã€‚

;; å˜ç´”ãªincã®é©ç”¨ã€‚
(-> 1
    inc
    inc
    inc)

;; 50å††ã®å•†å“ã‚’10å€‹è²·ã£ãŸåˆè¨ˆå€¤(ç¨ç‡10ï¼…)ã€‚
(->> 50
     (* 10)
     (* 1.10)
     int
     (str "total: "))
;; "total: 550"
```

## ãƒã‚¯ãƒ­å±•é–‹ã®æ¤œè¨¼

ã•ã¦ã€ã“ã‚Œã‚’`macroexpand-1`ã‚’ä½¿ã£ã¦å±•é–‹ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

```clojure
(macroexpand-1 '(-> x f g h))
;; (h (g (f x)))

(macroexpand-1 '(->> x f g h))
;; (h (g (f x)))
```

ä¸€è¦‹ã€ä½•ã‚‚é•ã„ãŒç„¡ã„ã‚ˆã†ã«è¦‹ãˆã¾ã™ãŒ...

```clojure
(macroexpand-1 '(-> x (f 1) (g 2 3) h))
;; (h (g (f x 1) 2 3))

(macroexpand-1 '(->> x (f 1) (g 2 3) h))
;; (h (g 2 3 (f 1 x)))
```

å±•é–‹ã™ã‚‹å¼•æ•°ã®é †ç•ªãŒç•°ãªã‚‹ã‚ˆã†ã§ã™ã€‚

ã“ã®å±•é–‹ã®é•ã„ã‚’æ„è­˜ã—ã¦ã„ãªã„ã¨ã€æ„å›³ã—ãªã„çµæœã¨ãªã‚‹ã“ã¨ã«æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚

```clojure
;; ->> ã§ã¯ãªã -> ã«ã—ãŸã¨ã“ã‚ã€æ„å›³ã—ãªã„çµæœã¨ãªã£ã¦ã—ã¾ã£ãŸã€‚
(-> 50
    (* 10)
    (* 1.10)
    int
    (str "total: "))
;; "550total: "

```

## çµ‚ã‚ã‚Šã«

ä»Šå›ã¯ã‚¹ãƒ¬ãƒƒãƒ‡ã‚£ãƒ³ã‚°ãƒã‚¯ãƒ­ã®ã†ã¡`->`ã¨`->>`ã‚’æŒ™ã’ã¾ã—ãŸãŒã€ä»–ã«ã‚‚ã‚¹ãƒ¬ãƒƒãƒ‡ã‚£ãƒ³ã‚°ãƒã‚¯ãƒ­ã¯ã‚ã‚‹ã‚ˆã†ãªã®ã§ã€åˆ†ã‹ã‚Šæ¬¡ç¬¬~~éŠã‚“ã§~~æ¤œè¨¼ã—ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚

# å‚è€ƒ

https://clojuredocs.org/clojure.core/macroexpand-1

https://clojure.org/guides/threading_macros

https://note.com/mi_nil/n/n78f1701bccb0